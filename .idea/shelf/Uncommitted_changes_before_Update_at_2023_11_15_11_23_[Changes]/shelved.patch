Index: laborBackend-labor/src/main/resources/mapper/labor/EmpTrainMapper.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\" ?>\r\n<!DOCTYPE mapper\r\n        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\r\n        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\">\r\n<mapper namespace=\"com.yuantu.labor.mapper.EmpTrainMapper\">\r\n\r\n    <resultMap type=\"com.yuantu.labor.domain.EmpTrain\" id=\"EmpTrainResult\">\r\n        <result property=\"trainId\" column=\"train_id\"/>\r\n        <result property=\"trainProjectId\" column=\"train_project_id\"/>\r\n        <result property=\"trainProjectName\" column=\"train_project_name\"/>\r\n        <result property=\"trainPeriod\" column=\"train_period\"/>\r\n        <result property=\"trainFee\" column=\"train_fee\"/>\r\n        <result property=\"trainAddrMethod\" column=\"train_addr_method\"/>\r\n        <result property=\"trainBeginTime\" column=\"train_begin_time\"/>\r\n        <result property=\"trainEndTime\" column=\"train_end_time\"/>\r\n        <result property=\"trainExamMethod\" column=\"train_exam_method\"/>\r\n        <result property=\"trainEmpId\" column=\"train_emp_id\"/>\r\n        <result property=\"trainEmpName\" column=\"train_emp_name\"/>\r\n        <result property=\"trainEmpIdcard\" column=\"train_emp_idcard\"/>\r\n        <result property=\"trainWorkUnitsId\" column=\"train_work_units_id\"/>\r\n        <result property=\"trainWorkUnitsName\" column=\"train_work_units_name\"/>\r\n        <result property=\"trainHrCompanyId\" column=\"train_hr_company_id\"/>\r\n        <result property=\"trainHrCompanyName\" column=\"train_hr_company_name\"/>\r\n        <result property=\"createBy\" column=\"create_by\"/>\r\n        <result property=\"createTime\" column=\"create_time\"/>\r\n        <result property=\"updateBy\" column=\"update_by\"/>\r\n        <result property=\"updateTime\" column=\"update_time\"/>\r\n    </resultMap>\r\n    <resultMap type=\"com.yuantu.labor.vo.EmpTrainResultVO\" id=\"EmpTrainVOResult\">\r\n        <result property=\"trainId\" column=\"train_id\"/>\r\n        <result property=\"trainProjectId\" column=\"train_project_id\"/>\r\n        <result property=\"trainProjectName\" column=\"train_project_name\"/>\r\n        <result property=\"trainPeriod\" column=\"train_period\"/>\r\n        <result property=\"trainFee\" column=\"train_fee\"/>\r\n        <result property=\"trainAddrMethod\" column=\"train_addr_method\"/>\r\n        <result property=\"trainBeginTime\" column=\"train_begin_time\"/>\r\n        <result property=\"trainEndTime\" column=\"train_end_time\"/>\r\n        <result property=\"trainExamMethod\" column=\"train_exam_method\"/>\r\n        <result property=\"trainEmpId\" column=\"train_emp_id\"/>\r\n        <result property=\"trainEmpName\" column=\"train_emp_name\"/>\r\n        <result property=\"trainEmpIdcard\" column=\"train_emp_idcard\"/>\r\n        <result property=\"trainWorkUnitsId\" column=\"train_work_units_id\"/>\r\n        <result property=\"trainWorkUnitsName\" column=\"train_work_units_name\"/>\r\n        <result property=\"trainHrCompanyId\" column=\"train_hr_company_id\"/>\r\n        <result property=\"trainHrCompanyName\" column=\"train_hr_company_name\"/>\r\n        <result property=\"createBy\" column=\"create_by\"/>\r\n        <result property=\"createTime\" column=\"create_time\"/>\r\n        <result property=\"updateBy\" column=\"update_by\"/>\r\n        <result property=\"updateTime\" column=\"update_time\"/>\r\n        <result property=\"projectContent\" column=\"project_content\"/>\r\n        <result property=\"projectNature\" column=\"project_nature\"/>\r\n    </resultMap>\r\n    <resultMap type=\"com.yuantu.labor.vo.EmpTrainCountVO\" id=\"EmpTrainCountResult\">\r\n        <result property=\"trainPeriod\" column=\"train_period\"/>\r\n        <result property=\"trainFee\" column=\"train_fee\"/>\r\n        <result property=\"trainEmpId\" column=\"train_emp_id\"/>\r\n        <result property=\"trainEmpName\" column=\"train_emp_name\"/>\r\n        <result property=\"trainEmpIdcard\" column=\"train_emp_idcard\"/>\r\n        <result property=\"trainWorkUnitsName\" column=\"train_work_units_name\"/>\r\n        <result property=\"trainHrCompanyName\" column=\"train_hr_company_name\"/>\r\n        <result property=\"projectNature\" column=\"project_nature\"/>\r\n\r\n\r\n    </resultMap>\r\n\r\n    <sql id=\"selectEmpTrainVo\">\r\n        select train_id,\r\n               train_project_id,\r\n               train_project_name,\r\n               train_period,\r\n               train_fee,\r\n               train_addr_method,\r\n               train_begin_time,\r\n               train_end_time,\r\n               train_exam_method,\r\n               train_emp_id,\r\n               train_emp_name,\r\n               train_emp_idcard,\r\n               train_work_units_id,\r\n               train_work_units_name,\r\n               train_hr_company_id,\r\n               train_hr_company_name,\r\n               create_by,\r\n               create_time,\r\n               update_by,\r\n               update_time\r\n        from emp_train\r\n    </sql>\r\n\r\n    <select id=\"selectEmpTrainList\" parameterType=\"com.yuantu.labor.domain.EmpTrain\" resultMap=\"EmpTrainResult\">\r\n        <include refid=\"selectEmpTrainVo\"/>\r\n        <where>\r\n            <if test=\"trainProjectId != null \">and train_project_id = #{trainProjectId}</if>\r\n            <if test=\"trainProjectName != null  and trainProjectName != ''\">and train_project_name like concat('%',\r\n                #{trainProjectName}, '%')\r\n            </if>\r\n            <if test=\"trainPeriod != null \">and train_period = #{trainPeriod}</if>\r\n            <if test=\"trainFee != null \">and train_fee = #{trainFee}</if>\r\n            <if test=\"trainAddrMethod != null  and trainAddrMethod != ''\">and train_addr_method = #{trainAddrMethod}\r\n            </if>\r\n            <if test=\"trainBeginTime != null \">and train_begin_time = #{trainBeginTime}</if>\r\n            <if test=\"trainEndTime != null \">and train_end_time = #{trainEndTime}</if>\r\n            <if test=\"trainExamMethod != null  and trainExamMethod != ''\">and train_exam_method = #{trainExamMethod}\r\n            </if>\r\n            <if test=\"trainEmpId != null \">and train_emp_id = #{trainEmpId}</if>\r\n            <if test=\"trainEmpName != null  and trainEmpName != ''\">and train_emp_name like concat('%', #{trainEmpName},\r\n                '%')\r\n            </if>\r\n            <if test=\"trainEmpIdcard != null  and trainEmpIdcard != ''\">and train_emp_idcard = #{trainEmpIdcard}</if>\r\n            <if test=\"trainWorkUnitsId != null \">and train_work_units_id = #{trainWorkUnitsId}</if>\r\n            <if test=\"trainWorkUnitsName != null  and trainWorkUnitsName != ''\">and train_work_units_name like\r\n                concat('%', #{trainWorkUnitsName}, '%')\r\n            </if>\r\n            <if test=\"trainHrCompanyId != null \">and train_hr_company_id = #{trainHrCompanyId}</if>\r\n            <if test=\"trainHrCompanyName != null  and trainHrCompanyName != ''\">and train_hr_company_name like\r\n                concat('%', #{trainHrCompanyName}, '%')\r\n            </if>\r\n        </where>\r\n        <!-- 数据范围过滤 -->\r\n        ${params.dataScope}\r\n    </select>\r\n\r\n\r\n    <select id=\"selectEmpTrainByTrainId\" parameterType=\"Integer\" resultMap=\"EmpTrainResult\">\r\n        <include refid=\"selectEmpTrainVo\"/>\r\n        where train_id = #{trainId}\r\n    </select>\r\n\r\n    <insert id=\"insertEmpTrain\" parameterType=\"com.yuantu.labor.domain.EmpTrain\" useGeneratedKeys=\"true\"\r\n            keyProperty=\"trainId\">\r\n        insert into emp_train\r\n        <trim prefix=\"(\" suffix=\")\" suffixOverrides=\",\">\r\n            <if test=\"trainProjectId != null\">train_project_id,</if>\r\n            <if test=\"trainProjectName != null\">train_project_name,</if>\r\n            <if test=\"trainPeriod != null\">train_period,</if>\r\n            <if test=\"trainFee != null\">train_fee,</if>\r\n            <if test=\"trainAddrMethod != null\">train_addr_method,</if>\r\n            <if test=\"trainBeginTime != null\">train_begin_time,</if>\r\n            <if test=\"trainEndTime != null\">train_end_time,</if>\r\n            <if test=\"trainExamMethod != null\">train_exam_method,</if>\r\n            <if test=\"trainEmpId != null\">train_emp_id,</if>\r\n            <if test=\"trainEmpName != null\">train_emp_name,</if>\r\n            <if test=\"trainEmpIdcard != null\">train_emp_idcard,</if>\r\n            <if test=\"trainWorkUnitsId != null\">train_work_units_id,</if>\r\n            <if test=\"trainWorkUnitsName != null\">train_work_units_name,</if>\r\n            <if test=\"trainHrCompanyId != null\">train_hr_company_id,</if>\r\n            <if test=\"trainHrCompanyName != null\">train_hr_company_name,</if>\r\n            <if test=\"createBy != null\">create_by,</if>\r\n            <if test=\"createTime != null\">create_time,</if>\r\n        </trim>\r\n        <trim prefix=\"values (\" suffix=\")\" suffixOverrides=\",\">\r\n            <if test=\"trainProjectId != null\">#{trainProjectId},</if>\r\n            <if test=\"trainProjectName != null\">#{trainProjectName},</if>\r\n            <if test=\"trainPeriod != null\">#{trainPeriod},</if>\r\n            <if test=\"trainFee != null\">#{trainFee},</if>\r\n            <if test=\"trainAddrMethod != null\">#{trainAddrMethod},</if>\r\n            <if test=\"trainBeginTime != null\">#{trainBeginTime},</if>\r\n            <if test=\"trainEndTime != null\">#{trainEndTime},</if>\r\n            <if test=\"trainExamMethod != null\">#{trainExamMethod},</if>\r\n            <if test=\"trainEmpId != null\">#{trainEmpId},</if>\r\n            <if test=\"trainEmpName != null\">#{trainEmpName},</if>\r\n            <if test=\"trainEmpIdcard != null\">#{trainEmpIdcard},</if>\r\n            <if test=\"trainWorkUnitsId != null\">#{trainWorkUnitsId},</if>\r\n            <if test=\"trainWorkUnitsName != null\">#{trainWorkUnitsName},</if>\r\n            <if test=\"trainHrCompanyId != null\">#{trainHrCompanyId},</if>\r\n            <if test=\"trainHrCompanyName != null\">#{trainHrCompanyName},</if>\r\n            <if test=\"createBy != null\">#{createBy},</if>\r\n            <if test=\"createTime != null\">#{createTime},</if>\r\n\r\n        </trim>\r\n    </insert>\r\n\r\n    <update id=\"updateEmpTrain\" parameterType=\"com.yuantu.labor.domain.EmpTrain\">\r\n        update emp_train\r\n        <trim prefix=\"SET\" suffixOverrides=\",\">\r\n            <if test=\"trainProjectId != null\">train_project_id = #{trainProjectId},</if>\r\n            <if test=\"trainProjectName != null\">train_project_name = #{trainProjectName},</if>\r\n            <if test=\"trainPeriod != null\">train_period = #{trainPeriod},</if>\r\n            <if test=\"trainFee != null\">train_fee = #{trainFee},</if>\r\n            <if test=\"trainAddrMethod != null\">train_addr_method = #{trainAddrMethod},</if>\r\n            <if test=\"trainBeginTime != null\">train_begin_time = #{trainBeginTime},</if>\r\n            <if test=\"trainEndTime != null\">train_end_time = #{trainEndTime},</if>\r\n            <if test=\"trainExamMethod != null\">train_exam_method = #{trainExamMethod},</if>\r\n            <if test=\"trainEmpId != null\">train_emp_id = #{trainEmpId},</if>\r\n            <if test=\"trainEmpName != null\">train_emp_name = #{trainEmpName},</if>\r\n            <if test=\"trainEmpIdcard != null\">train_emp_idcard = #{trainEmpIdcard},</if>\r\n            <if test=\"trainWorkUnitsId != null\">train_work_units_id = #{trainWorkUnitsId},</if>\r\n            <if test=\"trainWorkUnitsName != null\">train_work_units_name = #{trainWorkUnitsName},</if>\r\n            <if test=\"trainHrCompanyId != null\">train_hr_company_id = #{trainHrCompanyId},</if>\r\n            <if test=\"trainHrCompanyName != null\">train_hr_company_name = #{trainHrCompanyName},</if>\r\n            <if test=\"updateBy != null\">update_by = #{updateBy},</if>\r\n            <if test=\"updateTime != null\">update_time = #{updateTime},</if>\r\n        </trim>\r\n        where train_id = #{trainId}\r\n    </update>\r\n\r\n    <delete id=\"deleteEmpTrainByTrainId\" parameterType=\"Integer\">\r\n        update emp_train\r\n        set disabled = 1\r\n        where train_id = #{trainId}\r\n    </delete>\r\n\r\n    <delete id=\"deleteEmpTrainByTrainIds\" parameterType=\"String\">\r\n        update emp_train set disabled = 1 where train_id in\r\n        <foreach item=\"trainId\" collection=\"array\" open=\"(\" separator=\",\" close=\")\">\r\n            #{trainId}\r\n        </foreach>\r\n    </delete>\r\n    <select id=\"selectEmpTrainListByWhere\" parameterType=\"com.yuantu.labor.vo.EmpTrainQueryVO\"\r\n            resultMap=\"EmpTrainVOResult\">\r\n        select train_id, train_project_id, project_name as train_project_name, train_period, train_fee,\r\n        train_addr_method,\r\n        train_begin_time, train_end_time, train_exam_method, train_emp_id, emp_name as train_emp_name, CAST(SP_DECRYPT(emp_idcard) AS CHAR(128)) as train_emp_idcard,\r\n        train_work_units_id, train_work_units_name, train_hr_company_id, train_hr_company_name,\r\n        emp_train.create_by,emp_train.create_time,emp_train.update_by,emp_train.update_time,\r\n        project_nature,project_content\r\n        from emp_train LEFT JOIN train_project ON emp_train.train_project_id = train_project.project_id\r\n        left join employee on emp_train.train_emp_id = employee.emp_id\r\n        <where>\r\n            <if test=\"empName != null and empName != ''\">and (emp_name like concat('%', #{empName}, '%') or CAST(SP_DECRYPT(emp_idcard) AS CHAR(128))  like concat('%', #{empName}, '%'))\r\n            </if>\r\n\r\n            <if test=\"trainEmpName != null  and trainEmpName != ''\">and emp_name like concat('%', #{trainEmpName},\r\n                '%')\r\n            </if>\r\n            <if test=\"trainEmpIdcard != null  and trainEmpIdcard != ''\">and CAST(SP_DECRYPT(emp_idcard) AS CHAR(128)) like concat('%',\r\n                #{trainEmpIdcard}, '%')\r\n            </if>\r\n            <if test=\"trainProjectName != null  and trainProjectName != ''\">and project_name like concat('%',\r\n                #{trainProjectName}, '%')\r\n            </if>\r\n            <if test=\"projectNature != null  and projectNature != ''\">and project_nature = #{projectNature}</if>\r\n\r\n            <if test=\"minTrainPeriod != null \">and train_period >= #{minTrainPeriod}</if>\r\n            <if test=\"maxTrainPeriod != null \">and train_period &lt;= #{maxTrainPeriod}</if>\r\n\r\n            <if test=\"minTrainFee != null \">and train_fee >= #{minTrainFee}</if>\r\n            <if test=\"maxTrainFee != null \">and train_fee &lt;= #{maxTrainFee}</if>\r\n            <if test=\"trainAddrMethod != null  and trainAddrMethod != ''\">and train_addr_method like concat('%',\r\n                #{trainAddrMethod},'%')\r\n            </if>\r\n            <if test=\"trainBeginTime != null \">and train_begin_time >= #{trainBeginTime}</if>\r\n            <if test=\"trainEndTime != null \">and train_end_time &lt;= #{trainEndTime}</if>\r\n            <if test=\"trainExamMethod != null  and trainExamMethod != ''\">and train_exam_method like concat('%',\r\n                #{trainExamMethod}, '%')\r\n            </if>\r\n\r\n            <if test=\"trainWorkUnitsName != null  and trainWorkUnitsName != ''\">and train_work_units_name like\r\n                concat('%', #{trainWorkUnitsName}, '%')\r\n            </if>\r\n            <if test=\"trainHrCompanyName != null  and trainHrCompanyName != ''\">and train_hr_company_name like\r\n                concat('%', #{trainHrCompanyName}, '%')\r\n            </if>\r\n            <if test=\"beginUpdateTime !=null\">and emp_train.update_time &gt;= #{beginUpdateTime}</if>\r\n            <if test=\"endUpdateTime !=null\">and emp_train.update_time &lt;= #{endUpdateTime}</if>\r\n            <if test=\"trainIds !=null\">\r\n                and train_id in\r\n                <foreach item=\"trainId\" collection=\"trainIds\" open=\"(\" separator=\",\" close=\")\">\r\n                    #{trainId}\r\n                </foreach>\r\n            </if>\r\n            <if test=\"isRelated !=null and isRelated == 1 \">and employee.disabled= 1</if>\r\n\r\n            and emp_train.disabled = 0\r\n        </where>\r\n        <!-- 数据范围过滤 -->\r\n        ${params.dataScope}\r\n    </select>\r\n\r\n    <select id=\"selectEmpTrainCounting\" parameterType=\"com.yuantu.labor.vo.EmpTrainQueryVO\"\r\n            resultMap=\"EmpTrainCountResult\">\r\n        select sum(train_period) as train_period, convert(sum(train_fee)/10000,decimal(15,1)) as train_fee,\r\n        train_emp_id, emp_name as train_emp_name, CAST(SP_DECRYPT(emp_idcard) AS CHAR(128)) as train_emp_idcard, train_work_units_name,train_hr_company_name,project_nature\r\n        from emp_train LEFT JOIN train_project ON emp_train.train_project_id = train_project.project_id\r\n        left join employee on emp_train.train_emp_id = employee.emp_id\r\n        <where>\r\n            <if test=\"empName != null and empName != ''\">and (emp_name like concat('%', #{empName}, '%') or CAST(SP_DECRYPT(emp_idcard) AS CHAR(128))  like concat('%', #{empName}, '%'))\r\n            </if>\r\n            <if test=\"projectNature != null  and projectNature != ''\">and project_nature = #{projectNature}</if>\r\n            <if test=\"trainWorkUnitsName != null  and trainWorkUnitsName != ''\">and train_work_units_name like\r\n                concat('%', #{trainWorkUnitsName}, '%')\r\n            </if>\r\n            <if test=\"trainHrCompanyName != null  and trainHrCompanyName != ''\">and train_hr_company_name like\r\n                concat('%', #{trainHrCompanyName}, '%')\r\n            </if>\r\n            and emp_train.disabled = 0\r\n\r\n        </where>\r\n        group by train_emp_id,project_nature, train_work_units_name,train_hr_company_name\r\n        <!-- 数据范围过滤 -->\r\n        ${params.dataScope}\r\n    </select>\r\n\r\n    <select id=\"selectEmpTrainCountByMonth\" parameterType=\"com.yuantu.labor.vo.EmpTrainQueryVO\" resultType=\"com.yuantu.labor.vo.EmpTrainTotalVO\">\r\n        select count(*) as totalCount, sum(train_fee) as totalFee, count(DISTINCT train_project_id) as totalProject,sum(train_period) totalPeriod from emp_train\r\n        where disabled = 0\r\n        <if test=\"isRelated != null  and isRelated == 0\">\r\n          and DATE_FORMAT(train_end_time,'%Y-%m') = #{month} and train_end_time &lt;=CURDATE()\r\n        </if>\r\n        <if test=\"isRelated != null  and isRelated == 1\">\r\n        and ( (DATE_FORMAT(train_end_time,'%Y-%m') = #{month} and train_end_time &lt;=CURDATE() ) or\r\n        (train_begin_time &lt; CURDATE() and train_end_time > CURDATE()))\r\n        </if>\r\n\r\n    </select>\r\n    <select id=\"countTrainExamMethod\" parameterType=\"com.yuantu.labor.vo.BudgetQueryVO\" resultType=\"com.yuantu.labor.vo.PieChartVO\">\r\n        select count(*) as value , dict_label as name\r\n        from emp_train\r\n            left join sys_dict_data on sys_dict_data.dict_type='train_exam_method' and sys_dict_data.dict_value = emp_train.train_exam_method\r\n        where disabled = 0\r\n        <if test=\"isRelated != null  and isRelated == 0\">\r\n            and DATE_FORMAT(train_end_time,'%Y-%m') = #{month} and train_end_time &lt;=CURDATE()\r\n        </if>\r\n        <if test=\"isRelated != null  and isRelated == 1\">\r\n            and ( (DATE_FORMAT(train_end_time,'%Y-%m') = #{month} and train_end_time &lt;=CURDATE() ) or\r\n            (train_begin_time &lt; CURDATE() and train_end_time > CURDATE()))\r\n        </if>\r\n\r\n        GROUP BY train_exam_method\r\n    </select>\r\n\r\n    <select id=\"countTrainPeriod\" resultType=\"Integer\">\r\n        select sum(train_period) as train_period\r\n        from emp_train LEFT JOIN train_project ON emp_train.train_project_id = train_project.project_id\r\n        <where>\r\n            <if test=\"empName != null and empName != ''\">and (train_emp_name like concat('%', #{empName}, '%') or\r\n                train_emp_idcard like concat('%', #{empName}, '%'))\r\n            </if>\r\n            <if test=\"projectNature != null  and projectNature != ''\">and project_nature = #{projectNature}</if>\r\n            <if test=\"trainWorkUnitsName != null  and trainWorkUnitsName != ''\">and train_work_units_name like\r\n                concat('%', #{trainWorkUnitsName}, '%')\r\n            </if>\r\n            <if test=\"trainHrCompanyName != null  and trainHrCompanyName != ''\">and train_hr_company_name like\r\n                concat('%', #{trainHrCompanyName}, '%')\r\n            </if>\r\n            and emp_train.disabled = 0\r\n        </where>\r\n    </select>\r\n    <select id=\"countTrainFee\" resultType=\"String\">\r\n        select convert(sum(train_fee)/10000,decimal(15,1)) as train_fee\r\n        from emp_train LEFT JOIN train_project ON emp_train.train_project_id = train_project.project_id\r\n        <where>\r\n            <if test=\"empName != null and empName != ''\">and (train_emp_name like concat('%', #{empName}, '%') or\r\n                train_emp_idcard like concat('%', #{empName}, '%'))\r\n            </if>\r\n            <if test=\"projectNature != null  and projectNature != ''\">and project_nature = #{projectNature}</if>\r\n            <if test=\"trainWorkUnitsName != null  and trainWorkUnitsName != ''\">and train_work_units_name like\r\n                concat('%', #{trainWorkUnitsName}, '%')\r\n            </if>\r\n            <if test=\"trainHrCompanyName != null  and trainHrCompanyName != ''\">and train_hr_company_name like\r\n                concat('%', #{trainHrCompanyName}, '%')\r\n            </if>\r\n            and emp_train.disabled = 0\r\n        </where>\r\n    </select>\r\n    <select id=\"checkEmpTrainUnique\" parameterType=\"com.yuantu.labor.domain.EmpTrain\" resultType=\"Integer\">\r\n        select count(*) from emp_train\r\n        <where>\r\n            <if test=\"trainId!=null\">train_id != #{trainId}</if>\r\n            <if test=\"trainProjectId != null \">and train_project_id = #{trainProjectId}</if>\r\n            <if test=\"trainEmpId != null \">and train_emp_id = #{trainEmpId}</if>\r\n            <if test=\"trainBeginTime != null \">and train_begin_time = DATE_FORMAT(#{trainBeginTime},'%Y-%m-%d')</if>\r\n            and disabled = 0\r\n        </where>\r\n\r\n    </select>\r\n    <select id=\"selectEmpTrainByEmpId\" parameterType=\"Integer\" resultMap=\"EmpTrainVOResult\">\r\n        select train_id,\r\n               train_project_id,\r\n               project_name as train_project_name,\r\n               train_period,\r\n               train_fee,\r\n               train_addr_method,\r\n               train_begin_time,\r\n               train_end_time,\r\n               train_exam_method,\r\n               train_emp_id,\r\n               train_emp_name,\r\n               train_emp_idcard,\r\n               train_work_units_id,\r\n               train_work_units_name,\r\n               train_hr_company_id,\r\n               train_hr_company_name,\r\n               emp_train.create_by,\r\n               emp_train.create_time,\r\n               emp_train.update_by,\r\n               emp_train.update_time,\r\n               project_nature,\r\n               project_content\r\n        from emp_train\r\n                 LEFT JOIN train_project ON emp_train.train_project_id = train_project.project_id\r\n        where train_emp_id = #{empId}\r\n          and emp_train.disabled = 0\r\n        ORDER BY train_begin_time\r\n    </select>\r\n    <select id=\"countEmpTrainNatureNumByEmpId\" parameterType=\"Integer\" resultType=\"com.yuantu.labor.vo.PieChartVO\">\r\n        select value, dict_label as name\r\n        from (select count(*) as value,project_nature as name\r\n              from emp_train LEFT JOIN train_project\r\n              ON emp_train.train_project_id = train_project.project_id\r\n              where train_emp_id =#{empId} and emp_train.disabled = 0\r\n              group by train_project.project_nature) as tempTable\r\n                 LEFT JOIN sys_dict_data\r\n                           on `tempTable`.`name` = sys_dict_data.dict_value and sys_dict_data.dict_type = 'train_nature'\r\n    </select>\r\n    <select id=\"countEmpTrainPeriodByEmpId\" parameterType=\"Integer\" resultType=\"com.yuantu.labor.vo.PieChartVO\">\r\n\r\n        select value, dict_label as name\r\n        from (select sum(train_period) as value,project_nature as name\r\n              from emp_train LEFT JOIN train_project\r\n              ON emp_train.train_project_id = train_project.project_id\r\n              where train_emp_id = #{empId} and emp_train.disabled = 0\r\n              group by train_project.project_nature) as tempTable\r\n                 LEFT JOIN sys_dict_data\r\n                           on `tempTable`.`name` = sys_dict_data.dict_value and sys_dict_data.dict_type = 'train_nature'\r\n    </select>\r\n\r\n    <select id=\"countRecentYearsTrainNumByEmpId\" parameterType=\"Integer\" resultType=\"com.yuantu.labor.vo.PieChartVO\">\r\n        select count(train_period) as value,c_year as name,'培训课程个数' as id\r\n        from\r\n            (\r\n            select year (now())-4 as c_year union all\r\n            select year (now())-3 as c_year union all\r\n            select year (now())-2 as c_year union all\r\n            select year (now())-1 as c_year union all\r\n            select year (now()) as c_year\r\n            ) as yeartab\r\n            LEFT JOIN emp_train\r\n        ON c_year = year (train_begin_time) and emp_train.disabled = 0 and train_emp_id = #{empId}\r\n        GROUP BY c_year\r\n    </select>\r\n    <select id=\"countRecentYearsTrainPeriodByEmpId\" parameterType=\"Integer\" resultType=\"com.yuantu.labor.vo.PieChartVO\">\r\n        select COALESCE(sum(train_period), 0) as value,c_year as name,'培训时长' as id\r\n        from\r\n            (\r\n            select year (now())-4 as c_year union all\r\n            select year (now())-3 as c_year union all\r\n            select year (now())-2 as c_year union all\r\n            select year (now())-1 as c_year union all\r\n            select year (now()) as c_year\r\n            ) as yeartab\r\n            LEFT JOIN emp_train\r\n        ON c_year = year (train_begin_time) and emp_train.disabled = 0 and train_emp_id = #{empId}\r\n        GROUP BY c_year\r\n    </select>\r\n\r\n    <select id=\"findInfosByEmpIds\" resultType=\"com.yuantu.labor.domain.EmpTrain\">\r\n        <include refid=\"selectEmpTrainVo\"/>\r\n        where disabled = 0 and train_emp_id in\r\n        <foreach collection=\"empIds\" item=\"empId\" open=\"(\" separator=\",\" close=\")\">\r\n            #{empId}\r\n        </foreach>\r\n    </select>\r\n    <select id=\"findInfosDuringOneYearByEmpIds\" resultType=\"com.yuantu.labor.domain.EmpTrain\">\r\n        <include refid=\"selectEmpTrainVo\"/>\r\n        where disabled = 0 and create_time >= DATE_SUB(NOW(), INTERVAL 1 YEAR) and train_emp_id in\r\n        <foreach collection=\"empIds\" item=\"empId\" open=\"(\" separator=\",\" close=\")\">\r\n            #{empId}\r\n        </foreach>\r\n    </select>\r\n\r\n</mapper>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/laborBackend-labor/src/main/resources/mapper/labor/EmpTrainMapper.xml b/laborBackend-labor/src/main/resources/mapper/labor/EmpTrainMapper.xml
--- a/laborBackend-labor/src/main/resources/mapper/labor/EmpTrainMapper.xml	(revision f9af9cf78ad5215e3b1f7a4bd6797e678d51c689)
+++ b/laborBackend-labor/src/main/resources/mapper/labor/EmpTrainMapper.xml	(date 1700018428655)
@@ -290,35 +290,6 @@
         <!-- 数据范围过滤 -->
         ${params.dataScope}
     </select>
-
-    <select id="selectEmpTrainCountByMonth" parameterType="com.yuantu.labor.vo.EmpTrainQueryVO" resultType="com.yuantu.labor.vo.EmpTrainTotalVO">
-        select count(*) as totalCount, sum(train_fee) as totalFee, count(DISTINCT train_project_id) as totalProject,sum(train_period) totalPeriod from emp_train
-        where disabled = 0
-        <if test="isRelated != null  and isRelated == 0">
-          and DATE_FORMAT(train_end_time,'%Y-%m') = #{month} and train_end_time &lt;=CURDATE()
-        </if>
-        <if test="isRelated != null  and isRelated == 1">
-        and ( (DATE_FORMAT(train_end_time,'%Y-%m') = #{month} and train_end_time &lt;=CURDATE() ) or
-        (train_begin_time &lt; CURDATE() and train_end_time > CURDATE()))
-        </if>
-
-    </select>
-    <select id="countTrainExamMethod" parameterType="com.yuantu.labor.vo.BudgetQueryVO" resultType="com.yuantu.labor.vo.PieChartVO">
-        select count(*) as value , dict_label as name
-        from emp_train
-            left join sys_dict_data on sys_dict_data.dict_type='train_exam_method' and sys_dict_data.dict_value = emp_train.train_exam_method
-        where disabled = 0
-        <if test="isRelated != null  and isRelated == 0">
-            and DATE_FORMAT(train_end_time,'%Y-%m') = #{month} and train_end_time &lt;=CURDATE()
-        </if>
-        <if test="isRelated != null  and isRelated == 1">
-            and ( (DATE_FORMAT(train_end_time,'%Y-%m') = #{month} and train_end_time &lt;=CURDATE() ) or
-            (train_begin_time &lt; CURDATE() and train_end_time > CURDATE()))
-        </if>
-
-        GROUP BY train_exam_method
-    </select>
-
     <select id="countTrainPeriod" resultType="Integer">
         select sum(train_period) as train_period
         from emp_train LEFT JOIN train_project ON emp_train.train_project_id = train_project.project_id
Index: laborBackend-labor/src/main/java/com/yuantu/labor/vo/EmpTrainTotalVO.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/laborBackend-labor/src/main/java/com/yuantu/labor/vo/EmpTrainTotalVO.java b/laborBackend-labor/src/main/java/com/yuantu/labor/vo/EmpTrainTotalVO.java
deleted file mode 100644
--- a/laborBackend-labor/src/main/java/com/yuantu/labor/vo/EmpTrainTotalVO.java	(revision f9af9cf78ad5215e3b1f7a4bd6797e678d51c689)
+++ /dev/null	(revision f9af9cf78ad5215e3b1f7a4bd6797e678d51c689)
@@ -1,13 +0,0 @@
-package com.yuantu.labor.vo;
-
-import lombok.Data;
-
-import java.math.BigDecimal;
-
-@Data
-public class EmpTrainTotalVO {
-    private Integer totalCount;
-    private BigDecimal totalFee;
-    private Integer totalProject;
-    private Integer totalPeriod;
-}
